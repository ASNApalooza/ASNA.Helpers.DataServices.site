<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="shortcut icon" href="favicon.ico">

    <title>Documentation Template</title>

    <!-- Bootstrap core CSS -->
    <!-- <link rel="stylesheet" href="http://netdna.bootstrapcdn.com/bootstrap/3.1.0/css/bootstrap.min.css"> -->
    <link href="public/vendor/bootstrap/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="public/css/index.css" rel="stylesheet">



    <!-- Just for debugging purposes. Don't actually copy this line! -->
    <!--[if lt IE 9]><script src="../../assets/js/ie8-responsive-file-warning.js"></script><![endif]-->

    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
      <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
    <style>
.content {padding-top: 80px ;padding-bottom: 20px}

@media (min-width:768px){
  #components .list-group {position: fixed; width:18%;}
}

@media (min-width:1024px){
  #components .list-group {position: fixed; width:18%;}
}

@media (min-width:1400px){
  #components .list-group {position: fixed; width:14%;}
}


@media (min-width:1920px){
  #components .list-group {position: fixed; width:14%;}
}


    </style>

  </head>

  <body>

    <div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="#">Home</a>
        </div>
        <div class="collapse navbar-collapse">
          <ul class="nav navbar-nav" id="tabs">
            <li><a href="#components" data-toggle="tab">Documentation</a></li>
            <li><a href="#about" data-toggle="tab">About</a></li>
          </ul>
        </div><!--/.nav-collapse -->
      </div>
    </div>

    <div class="content container tab-content">
      <div class="tab-pane active" id="home">
        <div class="jumbotron">
          <h1>Some Framework</h1>
          <p>This is a template for a documentation website for a programming framework or library. It includes a template for components description with a navigation list.</p>
          <p><a href="#" class="btn btn-primary btn-lg" role="button">Download &darr;</a></p>
        </div>
      </div>

      <div class="tab-pane" id="components">
        <div class="row">
          <div class="col-sm-3">
            <div class="list-group">
              <a href="#qf-overview" class="list-group-item">Overview</a>
              <a href="#qf-instance-args" class="list-group-item">QueryFileInstanceArgs</a>
              <a href="#item3" class="list-group-item">Item #3</a>
              <a href="#item4" class="list-group-item">Item #4</a>
              <a href="#item5" class="list-group-item">Item #5</a>
            </div>
          </div><!-- /.col-sm-3 -->

          <div class="col-sm-9">
            <!-- Item #1. -->
<!-- ||||||||||||||||||||||||||||||||||||||||||||||||||||||| -->
<!-- Content starts here -->
            <div id="qf-excel-to-file" class="content section">
              <h2>Export to Excel</h2>
              <p>This example shows how to use Walter to create an Excel spreadsheet in a Windows program and save it to a local file. A later section shows how you can use Walter to produce an Excel spreadsheet in an ASP.NET app. </p>
              <p>Walter's Excel output adapter uses the open source <a href="https://closedxml.codeplex.com/">ClosedXML library</a>, which provides a rational API over Microsoft's <a href="http://msdn.microsoft.com/en-us/library/office/bb448854(v=office.15).aspx">Open XML SDK for Office.</a>. I chose the ClosedXML library because it is an active project, has the features Walter needed, and has pretty good documentation. There are many alternatives for writing Excel spreadsheets in the .NET environment. If Walter's Excel output adapter doesn't suit you, write your own!</p>
              <p>Walter's default Excel output adapter accepts two query options (through Walter's Inputs.Options collection) to specify the spreadsheet heading and the worksheet name. Through clever use of the Inputs.Options collection a scheme could probably be produced to specify to the Excel output adapter to create column and row total formulas. This has been on my todo list for months. Alas, that's why Walter is open source! Help please!</p> 
                <pre><code>01  Using ASNA.Helpers.DataServices
02  
03  DclFld db           Type(AdgConnection)
04  DclFld Query        Type(QueryDriver) 
05  DclFld ExcelAdapter Type(ToExcelAdapter)
06
07  db = *New AdgConnection("*Public/IBMi")
08  
09  Query = *New QueryDriver(db)
10  Query.Args.Inputs.Library    = "examples"
11  Query.Args.Inputs.File       = "CMastNewL2"
12  Query.Args.Inputs.FieldsList = "CMCUSTNO:Number,CMNAME:Name,+
                                    CMADDR1:Address,CMCITY:City,CMSTATE:State"
13  Query.Args.Inputs.Rows       = 1000
14  Query.Args.Inputs.Query      = "CMSTATE = '{CMSTATE}'"
15  Query.Args.Inputs.QueryParms.Add(*New QueryField("CMSTATE",State))
16
17  Query.Args.Inputs.Options.Add("heading","Customer Listing")
18  Query.Args.Inputs.Options.Add("worksheet_name","Customers")
19
20  ExcelAdapter = *New ToExcelAdapter(Query.Args) 
21  Query.OverrideAdapter(*New ToExcelAdapter(Query.Args))
22  Query.Exec() 
23  db.Close()
24  ExcelAdapter.SaveToLocalFile("c:\users\public\documents\test.xlsx")</code></pre>


<div class="panel-group" id="accordion">
  <div class="panel panel-default">
    <div class="panel-heading">
      <h4 class="panel-title">
        <a data-toggle="collapse" data-parent="#accordion" href="#qf-excel-to-file-collapse">
          Toggle source code annotation
        </a>
      </h4>
    </div>
    <div id="qf-excel-to-file-collapse" class="panel-collapse collapse">
      <div class="panel-body">
                <table class="table table-striped">
                <tr>
                <th>Line</th>
                <th>Description</th>
                </tr>
                <tr>
                <td>01</td>
                <td>Make the QueryDriver, QueryField, and QueryType objects available without needing to qualify them with their namespace.</td>
                </tr>
                <tr>
                <td>03</td>
                <td>Declare a DataGate DB connection. </td>
                </tr>
                <tr>
                <td>04</td>
                <td>Declare an instance of the QueryDriver. </td>
                </tr>
                <tr>
                <td>05</td>
                <td>Declare an instance of the standard Excel output adapter. Note that it isn't instanced when you declare it--we'll instance it in a moment.</td>
                </tr> 
                <tr>
                <td>07</td>
                <td>Instance the database connection.</td>
                </tr>
                <tr>
                <td>09</td>
                <td>Instance the QueryFile object.</td>
                </tr>
                <tr>
                <td>10</td>
                <td>Specify the library for the query.</td>
                </tr>
                <tr>
                <td>11</td>
                <td>Specify the file for the query.</td>
                </tr>
                <tr>
                <td>12</td>
                <td>Specify a comma separated list of fields to include in the query results. In addition to the field name, you can also provide (preceded by a comma) a field name alias. The use of this alias is specific to an output adapter. The Excel output adapter uses these field aliases for column headings in the spreadsheet. For example, The CMCUSTNO field will have a column heading of "Number."</td>
                </tr>
                <tr>
                <td>13</td>
                <td>Specify the maximum number of rows for the query to return. Be especially careful with this value when using the Excel output adapter. The entire spreadsheet is created in memory before it is produced.</td>
                </tr>
                <tr>
                <td>14</td>
                <td>Specify the query.</td>
                </tr>
                <tr>
                <td>15</td>
                <td>The QueryParms collection provides the field values for the Query property. In this example, the replacement token {CMSTATE} is replaced by the value in the State variable (not declared in this code snippet) at runtime. For example, if the State variable value is 'IN' then the query in line 14 resolves to CMSTATE = 'IN' at runtime. Each field used in the query must be represented by a corresponding field in the QueryFields collection. </td>
                </tr>
                <tr>
                <td>17</td>
                <td>Specify query options. The use of query options is specific to the output adapter being used. The Excel output adapter uses two options. This option defines the heading used in the spreadsheet. </td>
                </tr>
                <tr>
                <td>18</td>
                <td>This query option specifies the spreadhseet worksheet name. If either the 'heading' or 'worksheet_name' options are omitted when using the Excel output adapter, default values are used.</td>
                </tr>
                <tr>
                <td>20</td>
                <td>Instance the standard Excel output adapter. Most output adapters require the Query.Args instance as the only constructor argument. This makes the input args available to adapter. How the adapter may use those values is specific to a given output adapter.</td>
                </tr>
                <tr>
                <td>21</td>
                <td>Override the output adapter with the newly instanced Excel adapter. When the output adapter is overridden no other query results are generated--query results are always passed out of Walter through a single query adapter. For example, having overridden the output adapter with the Excel output adapter the query will not generate a data table.</td>
                </tr>
                <tr>
                <td>22</td>
                <td>Call the QueryDriver's Exec() method to execute its query. In the case of the standard Excel output adapter, nothing is returned from this method.</td>
                </tr>
                <tr>
                <td>23</td>
                <td>Close the underlying database server connection. This should always be done after you use Walter's QueryFile.Exec() method. This connection does participate in connection pooling so there is very little overhead in reconnecting.  </td>
                </tr>
                <tr>
                <td>24</td>
                <td>Use the standard Excel output adapter's SaveToLocalFile() method to save the spreadsheet created. This option is only valid for use with Windows applications. Walter also has an ASP.NET helper class that can use the Excel output adapter in an ASP.NET app.</td>
                </tr>
                </table>
            </div> <!-- .panel-body -->
      </div><!-- panel-collapse collapse -->
    </div><!-- panel -->
</div><!-- panel group -->


<p>The spreadsheet produced by the code above is shown below:
<img src="public/images/spreadsheet.png" class="img-responsive">


                <hr>
            </div>
<!-- Content ends here -->
<!-- ||||||||||||||||||||||||||||||||||||||||||||||||||||||| -->
          </div>
        </div>
      </div>
    </div><!-- /.container -->

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->

    <!-- jQuery Version 1.11.0 -->
    <script src="public/vendor/jquery/dist/jquery.js"></script>

    <!-- Bootstrap Core JavaScript -->
    <script src="public/vendor/bootstrap/dist/js/bootstrap.min.js"></script>

    <script>
      /* scroll to top when clicked on navbar */
      $(".navbar > .container").on("click", function(e){
        $('html,body').animate({scrollTop:0},'slow');
      });

      /* brand logo click */
      $(".navbar-brand").on("click",function(){
        $("#home").addClass("active").siblings().removeClass("active");
        $("#tabs > li").removeClass("active");
      });

      /* make list-group selectable */
      $(".list-group>a").on("click", function(){
        $(this).addClass("active").siblings().removeClass("active");
      });

      /* auto select list-group item on scroll */
      $(document).scroll(function(){
        $('.section').each(function(){
          var position = $(document).scrollTop() - $(this).offset().top;
          if(position < 30 && position > -115) {
            $($('a[href$='+$(this).attr("id")+']')).click();
          }
        });      
      });

      /* set hash on tab select */
      $('#tabs a').click(function() {
        window.location.hash = $(this).attr("href");
        $(document).scrollTop(0);
        $(".list-group > a").removeClass("active");
      });

      $(document).ready(function(){

        if(window.location.hash !== ""){
          /* open tab based on hash value */
          if($('#tabs > li > a[href="'+window.location.hash+'"]').length){
            $('#tabs > li > a[href="'+window.location.hash+'"]').tab('show');
            setTimeout(function(){$(document).scrollTop(0)}, 200);
          }
          /* open tab and section based on hash value */
          if($('.list-group > a[href="'+window.location.hash+'"]').length){
            var tab = $('.list-group > a[href="'+window.location.hash+'"]').closest(".tab-pane").attr("id");
            $('a[href="#'+tab+'"]').tab('show');
            $('.list-group > a[href="'+window.location.hash+'"]').click();
            setTimeout(function(){$(document).scrollTop($(window.location.hash).offset().top)}, 200);
          }
        }
      });
    </script>
  </body>
</html>
